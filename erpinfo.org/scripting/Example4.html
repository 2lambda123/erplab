<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Example 4: A Complete Data Processing Script</title>

<link href="styles/erplab.css" rel="stylesheet" type="text/css" />
<style type="text/css">
<!--
p.paragraph {
margin-top:0in;
margin-right:0in;
margin-bottom:8.0pt;
margin-left:0in;
text-align:justify;
font-size:11.0pt;
font-family:Cambria;
}
p.LiteralText {
margin:0in;
margin-bottom:.0001pt;
font-size:10.0pt;
font-family:Helvetica;
}
-->
</style>
</head>

<body>
<p class="paragraph"><em>Note: A complete version of this script is available in <strong>Test_Data &gt; Script_Examples &gt; Script4.m</strong>.  There is also a script named <strong>Script4_cleanup.m</strong>, which you can use to delete the files created by this script.</em></p>
<p class="paragraph">Our next example is a more sophisticated and complete script for processing.  The script has plenty of internal documentation, so we won't explain it line by line here.   However, we'll describe a few new things that were not covered in the previous scripts.</p>
<p class="paragraph">A key difference between this script and the previous scripts is that the previous scripts were designed to make it easy to look at the data from each step with the EEGLAB GUI. This was accomplished by updating the ALLEEG and ALLERP structures at each step. This is useful when you are first learning about scripting. However, once you have the hang of it, it's easier (and requires less memory) to just do everything in the script. At the end, you can look at the EEG with the pop_eegplot() and pop_ploterp() commands (which you can invoke in the command window). You do not even need to launch the EEGLAB GUI to run this script.</p>
<p class="paragraph">ERPsets don't usually take up as much memory as datasets, so you may want to save the final <strong>ERP</strong> for each subject in <strong>ALLERP</strong> (as this script does). This can make it easier to do later steps that operate on multiple <strong>ERPs</strong> (e.g., making grand averages or measuring from multiple subjects' <strong>ERPs</strong>).</p>
<p class="paragraph">When the script is done running, you can launch the EEGLAB GUI and load in the files that you want to plot. Alternatively, you can plot them from the command line with <strong>pop_ploterps</strong>. The script saves an ERP for each subject in the first 6 elements in <strong>ALLERP</strong>, and it saves the unfiltered and filtered grand averages in <strong>ALLERP(7)</strong> and <strong>ALLERP(8)</strong>, respectively. Thus, you can plot bins 2 and 3 (showing channels 1-17) of the filtered grand average by typing <strong>pop_ploterps(ALLERP(8), [2 3], 1:17);</strong> on the command line after the script finishes running.</p>
<p class="paragraph">An important element of most scripts—especially ones that take a long time to run—is that they shouldn't try to interact with the user. That is, if you are going to start a script that runs for 2 hours and leave the computer unattended for those 2 hours, you don't want any of the commands to pop up a window that requires you to click on something before the program continues. For example, most ERPLAB commands that create files will, by default, pop up a window if the file already exists, asking you if you want to overwrite the old file. This is a useful safety feature, but it can be an annoyance in a script. For these commands, you may see the parameters <strong>'warning', 'on'</strong>. If you change this to <strong>'warning', 'off'</strong>, the warning window will not be produced if the file exists. The file will simply be overwritten. A good practice is to leave the warnings on the first time you run a script, just to make sure that everything is OK, and then turn the warnings off once you know the script works properly. In the script shown below, the warnings have been turned off.</p>
<p class="paragraph">Here's what the  script looks like:</p>
<p class="LiteralText">&nbsp;</p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% Clear memory and the command window</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">clear</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">clc</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; "> </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% Initialize the ALLERP structure and CURRENTERP</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">ALLERP = buildERPstruct([]);</span> </p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">CURRENTERP = 0;</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; "> </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% This defines the set of subjects</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">subject_list = {</span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'S1'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'S2'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'S3'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'S4'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'S5'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'S6'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">};</span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">nsubj = length(subject_list); </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% number of subjects</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; "> </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% Path to the parent folder, which contains the data folders for all subjects</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">home_path  = </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'/Users/luck/Documents/Software_Development/ERPLAB_Toolbox/Test_Data/'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">;</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; "> </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% Set the save_everything variable to 1 to save all of the intermediate files to the hard drive</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% Set to 0 to save only the initial and final dataset and ERPset for each subject</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">save_everything  = 0;</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; "> </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% Set the plot_PDFs variable to 1 to create PDF files with the waveforms</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% for each subject (set to 0 if you don't want to create the PDF files).</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">plot_PDFs = 1;</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; "> </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% Loop through all subjects</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:blue; ">for</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; "> s=1:nsubj</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">    </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">    fprintf(</span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'\n******\nProcessing subject %s\n******\n\n'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, subject_list{s});</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; "> </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">    </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% Path to the folder containing the current subject's data</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">    data_path  = [home_path subject_list{s} </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'/'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">];</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; "> </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">    </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% Check to make sure the dataset file exists</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">    </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% Initial filename = path plus Subject# plus _EEG.set</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">    sname = [data_path subject_list{s} </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'_EEG.set'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">];</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">    </span><span style="font-family:Helvetica; font-size:10.0pt; color:blue; ">if</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; "> exist(sname, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'file'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">)&lt;=0</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">            fprintf(</span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'\n *** WARNING: %s does not exist *** \n'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, sname);</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">            fprintf(</span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'\n *** Skip all processing for this subject *** \n\n'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">);</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; "> </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">    </span><span style="font-family:Helvetica; font-size:10.0pt; color:blue; ">else</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:blue; "> </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:blue; "> </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">%</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% Load original dataset</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">%</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        fprintf(</span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'\n\n\n**** %s: Loading dataset ****\n\n\n'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, subject_list{s});</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        EEG = pop_loadset(</span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'filename'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, [subject_list{s} </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'_EEG.set'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">], </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'filepath'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, data_path);</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; "> </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; "> </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; "> </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">%</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% Add the channel locations</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% We're assuming the file 'standard-10-5-cap385.elp' is somewhere</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% in the path.  This can be copied from</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% plugins/dipfit2.2/standard_BESA/ inside the eeglab</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% folder.</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">%</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        fprintf(</span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'\n\n\n**** %s: Adding channel location info ****\n\n\n'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, subject_list{s});</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        EEG = pop_chanedit(EEG, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'lookup'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">,</span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'standard-10-5-cap385.elp'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">);</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% Save dataset with _Chan suffix instead of _EEG</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        EEG.setname = [subject_list{s} </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'_Chan'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">]; </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% name for the dataset menu</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:blue; ">if</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; "> (save_everything)</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">            EEG = pop_saveset(EEG, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'filename'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, [EEG.setname </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'.set'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">], </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'filepath'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, data_path);</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:blue; ">end</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:blue; "> </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:blue; "> </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:blue; "> </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">%</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% Create EVENTLIST and save (pop_editeventlist adds _elist suffix)</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">%</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        fprintf(</span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'\n\n\n**** %s: Creating eventlist ****\n\n\n'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, subject_list{s});</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        EEG = pop_creabasiceventlist( EEG , </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'Newboundary'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, { -99 }, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'Stringboundary'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, { </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'boundary'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; "> }, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'Warning'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'off'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; "> );</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        EEG.setname = [EEG.setname </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'_elist'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">]; </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% name for the dataset menu</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:blue; ">if</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; "> (save_everything) </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">            EEG = pop_saveset(EEG, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'filename'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, [EEG.setname </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'.set'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">], </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'filepath'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, data_path);</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:blue; ">end</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:blue; "> </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:blue; "> </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:blue; "> </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">%</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% High-pass filter the EEG</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% Channels = 1 to 16; High-pass cutoff at 0.1 Hz;</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% No lowpass filter; Order of the filter = 2.</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% Type of filter = &quot;Butterworth&quot;; Remove DC offset; Filter</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% &quot;between&quot; boundary events</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">%</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        fprintf(</span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'\n\n\n**** %s: High-pass filtering EEG at 0.1 Hz ****\n\n\n'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, subject_list{s});               </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        EEG  = pop_basicfilter( EEG,  1:16 , </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'Cutoff'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, 0.1, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'Design'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'butter'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'Filter'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'highpass'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'Order'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">,  2, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'RemoveDC'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'on'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; "> );</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        EEG.setname = [EEG.setname </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'_hpfilt'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">];</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:blue; ">if</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; "> (save_everything) </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">            EEG = pop_saveset(EEG, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'filename'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, [EEG.setname </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'.set'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">], </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'filepath'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, data_path);               </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:blue; ">end</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:blue; "> </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:blue; "> </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:blue; "> </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">%</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% Use Channel operations to insert a bipolar EOG channel</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% and re-reference to the average of the earlobes</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% Equations are stored in 'chanops_reref_biveog.txt', which</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% must be in the home directory for the experiment.</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% Save output with _ref suffix.</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">%</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        EEG = pop_eegchanoperator(EEG, [home_path </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'chanops_reref_biveog.txt'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">]);</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        EEG.setname = [EEG.setname </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'_ref'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">];</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:blue; ">if</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; "> (save_everything) </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">            EEG = pop_saveset(EEG, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'filename'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, [EEG.setname </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'.set'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">], </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'filepath'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, data_path);</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:blue; ">end</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:blue; "> </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:blue; "> </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:blue; "> </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">%</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% Use Binlister to sort the bins and save with _bins suffix</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% We are assuming that 'binlister_demo_1.txt' is present in the</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% home folder.</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">%</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        fprintf(</span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'\n\n\n**** %s: Running BinLister ****\n\n\n'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, subject_list{s});        </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        EEG  = pop_binlister( EEG , </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'BDF'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, [home_path </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'binlister_demo_1.txt'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">], </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'ImportEL'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'no'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'Saveas'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'off'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'SendEL2'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'EEG'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'Warning'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'off'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; "> );</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        EEG.setname = [EEG.setname </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'_bins'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">];</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:blue; ">if</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; "> (save_everything) </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">            EEG = pop_saveset(EEG, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'filename'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, [EEG.setname </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'.set'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">], </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'filepath'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, data_path);</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:blue; ">end</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:blue; "> </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:blue; "> </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:blue; "> </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">%</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% Extracts bin-based epochs (200 ms pre-stim, 800 ms post-stim. Baseline correction by pre-stim window)</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% Then save with _be suffix</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">%</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        fprintf(</span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'\n\n\n**** %s: Bin-based epoching ****\n\n\n'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, subject_list{s});</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        EEG = pop_epochbin( EEG , [-200.0  800.0],  </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'pre'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">);</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        EEG.setname = [EEG.setname </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'_epochs'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">];</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:blue; ">if</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; "> (save_everything) </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">            EEG = pop_saveset(EEG, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'filename'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, [EEG.setname </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'.set'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">], </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'filepath'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, data_path); </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:blue; ">end</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:blue; "> </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:blue; "> </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:blue; "> </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% Two rounds of artifact detection, then export eventlist just for fun</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% Save the processed EEG to disk because the next step will be averaging</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        fprintf(</span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'\n\n\n**** %s: Artifact detection (moving window peak-to-peak and step function) ****\n\n\n'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, subject_list{s});               </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">%</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% Artifact detection. Moving window. Test window = [-200</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% 798]; Threshold = 100 uV; Window width = 200 ms;</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% Window step = 50 ms; Channels = 1 to 17; Flags to be activated = 1 &amp; 4</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">%</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        EEG = pop_artmwppth( EEG , </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'Channel'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">,  1:17, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'Flag'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, [ 1 4], </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'Review'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'off'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'Threshold'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">,  100, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'Twindow'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, [ -200 798], </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'Windowsize'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">,  200, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'Windowstep'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">,  50 );</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">%</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% Artifact detection. Step-like artifacts in the bipolar</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% VEOG channel (channel 14, created earlier with Channel Operations)</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% Threshold = 30 uV; Window width = 400 ms;</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% Window step = 10 ms; Flags to be activated = 1 &amp; 3</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        EEG = pop_artstep( EEG , </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'Channel'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">,  14, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'Flag'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, [ 1 3], </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'Review'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'off'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'Threshold'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">,  30, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'Twindow'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, [ -200 798], </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'Windowsize'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">,  400, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'Windowstep'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">,  10 );</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        EEG.setname = [EEG.setname </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'_ar'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">];</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        EEG = pop_saveset(EEG, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'filename'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, [EEG.setname </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'.set'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">], </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'filepath'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, data_path);</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        EEG = pop_exporteegeventlist(EEG, [data_path subject_list{s} </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'_eventlist_ar.txt'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">]);</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; "> </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; "> </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">%</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% Averaging. Only good trials.  Include standard deviation.  Save to disk.</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">%</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        fprintf(</span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'\n\n\n**** %s: Averaging ****\n\n\n'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, subject_list{s});               </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        ERP = pop_averager( EEG, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'Criterion'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'good'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'Stdev'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'on'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">);</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        ERP.erpname = [subject_list{s} </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'_ERPs'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">];  </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% name for erpset menu</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        pop_savemyerp(ERP, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'erpname'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, ERP.erpname, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'filename'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, [ERP.erpname </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'.erp'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">], </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0;">'filepath'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, data_path, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'warning'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'off'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">);</span> </p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; "> </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; "> </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; "> </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">%</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% Filtering ERP. Channels = 1 to 17; No high-pass;</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% Lowpass cutoff at 30 Hz; Order of the filter = 2.</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% Type of filter = &quot;Butterworth&quot;; Do not remove DC offset</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">%</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        fprintf(</span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'\n\n\n**** %s: Low-pass filtering ERP at 30 Hz ****\n\n\n'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, subject_list{s});               </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        ERP = pop_filterp( ERP,1:17 , </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'Cutoff'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">,30, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'Design'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'butter'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'Filter'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'lowpass'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'Order'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">,2 ); </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        ERP.erpname = [ERP.erpname </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'_30Hz'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">];  </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% name for erpset menu</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:blue; ">if</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; "> (save_everything) </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">            pop_savemyerp(ERP, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'erpname'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, ERP.erpname, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'filename'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, [ERP.erpname </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'.erp'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">], </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0;">'filepath'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, data_path, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'warning'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'off'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">);</span> </p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:blue; ">end</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:blue; "> </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:blue; "> </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">%</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% Bin Operations. Create a difference wave and save with _diff suffix</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% Do this on the unfiltered data, so first reload unfiltered file</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% Then do a second round of bin operations and save with _plus suffix</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">%</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        fprintf(</span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'\n\n\n**** %s: Bin Operations (two passes) ****\n\n\n'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, subject_list{s});               </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        fname = [subject_list{s} </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'_ERPs.erp'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">];  </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% Re-create filename for unfiltered ERP</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        ERP = pop_loaderp( </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'filename'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, fname, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0;">'filepath'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, data_path, <span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0;">'Multiload', 'off'</span>, <span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0;">'overwrite'</span>, <span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0;">'off'</span>, <span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0;">'Warning'</span>, <span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0;">'on'</span>);   </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% Load the file   </span> </p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% Now make the difference wave, directly specifying the</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% equation that modifies the existing ERPset</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        ERP = pop_binoperator( ERP, {</span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'b3= b2-b1 label Rare minus Frequent difference wave'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; "> });</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        ERP.erpname = [ERP.erpname </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'_diff'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">];  </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% name for erpset menu</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:blue; ">if</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; "> (save_everything) </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">            pop_savemyerp(ERP, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'erpname'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, ERP.erpname, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'filename'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, [ERP.erpname </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'.erp'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">], </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0;">'filepath'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, data_path, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'warning'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'off'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">);</span> </p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:blue; ">end</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% Now we will do bin operations using a set of equations</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% stored in the file 'bin_equations.txt', which must be in</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% the home folder for the experiment</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        ERP = pop_binoperator( ERP, [home_path </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'bin_equations.txt'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">]);</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        ERP.erpname = [ERP.erpname </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'_plus'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">];  </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% name for erpset menu</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        pop_savemyerp(ERP, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'erpname'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, ERP.erpname, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'filename'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, [ERP.erpname </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'.erp'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">], </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0;">'filepath'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, data_path, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'warning'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'off'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">);</span> </p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% Save this final ERP in the ALLERP structure.  This is not</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% necessary unless you want to see the ERPs in the GUI or if you</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% want to access them with another function (e.g., pop_gaverager)</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        CURRENTERP = CURRENTERP + 1;</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        ALLERP(CURRENTERP) = ERP;</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; "> </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:blue; ">if</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; "> (plot_PDFs)</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">            pop_ploterps(ERP, [1 2], 1:17, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'Style'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0;">'Matlab'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">);</span> </p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">            pop_fig2pdf([data_path subject_list{s} </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'.pdf'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">]);</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; color:blue; ">end</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:blue; "> </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">    </span><span style="font-family:Helvetica; font-size:10.0pt; color:blue; ">end</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; "> </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% end of the &quot;if/else&quot; statement that makes sure the file exists</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">        </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:blue; ">end</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; "> </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% end of looping through all subjects</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; "> </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% Make a grand average. The final ERP from each subject was saved in</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% ALLERP, and we have nsubj subjects, so the indices of the ERPs to be averaged</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% together are 1:nsubj</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% We'll also create a filtered version and save it</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">ERP = pop_gaverager( ALLERP , </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'Criterion'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, 100, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'ERPindex'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, [ 1:nsubj] ); </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">%'Criterion', 100 is left over from a previous version</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">ERP.erpname = </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'grand_avg'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">;  </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% name for erpset menu</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">ERP = pop_savemyerp(ERP, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'filename'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, [ERP.erpname </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'.erp'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">], </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0;">'filepath'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, home_path, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'warning'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'off'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">);</span> </p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">CURRENTERP = CURRENTERP + 1;</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">ALLERP(CURRENTERP) = ERP;</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">ERP = pop_filterp( ERP,1:17 , </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'Cutoff'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">,30, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'Design'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'butter'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'Filter'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'lowpass'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'Order'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">,2 ); </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">ERP.erpname = [ERP.erpname </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'_30Hz'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">];  </span><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% name for erpset menu</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">ERP = pop_savemyerp(ERP, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'filename'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, [ERP.erpname </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'.erp'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">], </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0;">'filepath'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, home_path, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'warning'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'off'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">);</span> </p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">CURRENTERP = CURRENTERP + 1;</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">ALLERP(CURRENTERP) = ERP;</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; "> </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% Measure the mean amplitude from 300-600 ms in bins 2 and 3, channels 11-13.</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% Save the results in a variable named &quot;values&quot; and in a file named</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:forestgreen; ">% &quot;measures.txt&quot; in the home folder for the experiment.</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">values = pop_geterpvalues( ALLERP, [300 600], [2 3], 11:13 , </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'Baseline'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'pre'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'Erpsets'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, [1:nsubj], </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'Filename'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, [home_path </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'measures.txt'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">], </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'Fracreplace'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'NaN'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'Measure'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'meanbl'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">, </span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'Resolution'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">,1 );</span> </p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; "> </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; "> </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">fprintf(</span><span style="font-family:Helvetica; font-size:10.0pt; color:#A020F0; ">'\n\n\n**** FINISHED ****\n\n\n'</span><span style="font-family:Helvetica; font-size:10.0pt; color:black; ">);</span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="MsoNormal" style="margin-bottom:.0001pt;text-autospace:none;"><span style="font-family:Helvetica; font-size:10.0pt; color:black; "> </span><span style="font-family:Helvetica; font-size:10.0pt; "> </span></p>
<p class="LiteralText">&nbsp;</p>
<p class="LiteralText">&nbsp;</p>
<p class="paragraph">&nbsp;</p>
<p>&nbsp;</p>
<table width="100%" border="0">
  <tr>
    <td><a href="Example3c.html">&lt;&lt;Example 3c</a></td>
    <td><a href="index.html">Table of Contents</a></td>
    <td><a href="Debugging.html">Debugging&gt;&gt;</a></td>
  </tr>
</table>
</body>
</html>
