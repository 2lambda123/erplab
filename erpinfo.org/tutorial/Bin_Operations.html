<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Combining ERP Waveforms with Bin Operations</title>

<link href="styles/erplab.css" rel="stylesheet" type="text/css" />
<style type="text/css">
<!--
p.paragraph {
margin-top:0in;
margin-right:0in;
margin-bottom:8.0pt;
margin-left:0in;
font-size:11.0pt;
font-family:Cambria;
}
-->
</style>
<style type="text/css">
<!--
p.MsoNormal {
margin:0in;
margin-bottom:.0001pt;
font-size:12.0pt;
font-family:Cambria;
}
-->
</style>
<style type="text/css">
<!--
p.LiteralText {
margin:0in;
margin-bottom:.0001pt;
font-size:10.0pt;
font-family:Helvetica;
}
-->
</style>
<style type="text/css">
<!--
table.MsoNormalTable {
font-size:10.0pt;
font-family:Cambria;
}
-->
</style>
<style type="text/css">
<!--
p.CommandWindowText {
margin:0in;
margin-bottom:.0001pt;
text-align:justify;
font-size:9.0pt;
font-family:Courier;
}
-->
</style>
</head>

<body>
<p class="paragraph">The <strong>ERPLAB &gt; ERP Bin Operations</strong> routine allows you to create new bins by combining existing bins from the current ERPset.  This is most often used to create difference waves or to average across bins.</p>
<p class="paragraph">Bin Operations has two modes of operation.  In one mode, you use a set of equations to modify existing bins and add new bins within the current ERPset.  In this mode, you can modify one bin and then use this modified bin to create or modify another bin (this is called <em>recursive updating</em>).  In another mode, the current ERPset serves as the input to a set of equations that create a new set of bins in a new ERPset (this is called performing a set of<em> independent transformations</em>).  We will begin with modifying an existing ERPset, which is the simplest way to simply add a few bins.</p>
<h2 class="paragraph">Modifying an existing ERPset (recursive updating)</h2>
<p class="paragraph">As our first example, we will <strong>ERPLAB &gt; ERP Operations &gt; ERP Bin Operations</strong> to make a difference wave, in which the ERP from the frequent stimuli is subtracted from the ERP from the rare stimuli.  We will operate on the data in the ERPset you created earlier called &quot;S1_ERPs_30Hz&quot;, so make sure it is selected in the <strong>ERPset</strong> menu.  It's usually a good idea to operate on a duplicate of an ERPset, so first select <strong>ERPLAB &gt; Duplicate or rename current ERPset</strong> and then make a duplicate of it called &quot;S1_ERPs_30Hz_copy&quot;, as shown in the screenshot below.</p>
<p class="paragraph"><img src="../Images/tutorial_bin operations_1.png" width="442" height="319" /></p>
<div style="border:double windowtext 3.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt;">
  <p class="MsoNormal" style="text-autospace:none;border:none;padding:0in;"><strong>Equivalent Script Command:</strong></p>
  <p class="MsoNormal" style="text-autospace:none;border:none;padding:0in;"><span style="font-family:Courier; color:forestgreen; ">&nbsp;</span></p>
  <p class="MsoNormal" style="text-autospace:none;border:none;padding:0in;"><span style="font-size:11.0pt; color:forestgreen; ">%Load ERP S1_ERPs_30Hz</span><span style="font-size:11.0pt; color:forestgreen; "> </span></p>
  <p class="MsoNormal" style="text-autospace:none;border:none;padding:0in;"><span style="font-size:11.0pt; color:forestgreen; ">%Path is /Users/etfoo/Desktop/tutorial_script/</span></p>
  <p class="MsoNormal" style="text-autospace:none;border:none;padding:0in;"><span style="font-size:11.0pt; color:forestgreen; ">%Note that you will need to replace the path with the actual location in your file system</span><span style="font-size:11.0pt; color:forestgreen; "> </span></p>
  <p class="MsoNormal" style="text-autospace:none;border:none;padding:0in;"><span style="font-size:11.0pt; color:black; ">ERP = pop_loaderp( 'filename',</span><span style="font-size:11.0pt; color:#A020F0; ">'S1_ERPs_30Hz.erp'</span><span style="font-size:11.0pt; color:black; ">,</span><span style="font-size:11.0pt; color:blue; "> </span><span style="font-size:11.0pt; color:black; ">  'pathname',</span><span style="font-size:11.0pt; color:#A020F0; ">'/Users/etfoo/Desktop/tutorial_script/'</span>, <span style="font-size:11.0pt; color:#A020F0; ">
'overwrite'</span>, <span style="font-size:11.0pt; color:#A020F0; ">
'off'</span></span><span style="font-size:11.0pt; color:black; ">);  </span><span style="font-size:11.0pt; color:black; "> </span></p>
  <p class="MsoNormal" style="text-autospace:none;border:none;padding:0in;"><span style="font-size:11.0pt; color:forestgreen; ">%The following command uses Matlab's <em>Current Folder</em></span><em><span style="font-size:11.0pt; color:forestgreen; "> </span></em></p>
  <p class="MsoNormal" style="text-autospace:none;border:none;padding:0in;"><span style="font-size:11.0pt; color:black; ">ERP = pop_loaderp(</span><span style="font-size:11.0pt; color:black; ">{</span><span style="font-size:11.0pt; color:#A020F0; ">'S1_ERPs_30Hz.erp'</span><span style="font-size:11.0pt; color:black; "> });  </span><span style="font-size:11.0pt; color:black; "> </span></p>
  <p class="MsoNormal" style="text-autospace:none;border:none;padding:0in;"><span style="font-size:11.0pt; ">&nbsp;</span></p>
  <p class="MsoNormal" style="text-autospace:none;border:none;padding:0in;"><span style="font-size:11.0pt; color:forestgreen; ">%Duplicate S1_ERPs_30Hz to S1_ERPs_30Hz_copy</span><span style="font-size:11.0pt; color:forestgreen; "> </span></p>
  <p class="MsoNormal" style="text-autospace:none;border:none;padding:0in;"><span style="font-size:11.0pt; color:forestgreen; ">%Path is /Users/etfoo/Desktop/tutorial_script/</span></p>
  <p class="MsoNormal" style="text-autospace:none;border:none;padding:0in;"><span style="font-size:11.0pt; color:forestgreen; ">%Note that you will need to replace the path with the actual location in your file system</span><span style="font-size:11.0pt; color:forestgreen; "> </span></p>
  <p class="MsoNormal" style="text-autospace:none;border:none;padding:0in;"><span style="font-size:11.0pt; color:black; ">ERP = pop_savemyerp(ERP, </span><span style="font-size:11.0pt; color:#A020F0; ">'erpname'</span><span style="font-size:11.0pt; color:black; ">, </span><span style="font-size:11.0pt; color:#A020F0; ">'S1_ERPs_30Hz_copy.set'</span><span style="font-size:11.0pt; color:black; ">, </span><span style="font-size:11.0pt; color:#A020F0; ">'filename'</span><span style="font-size:11.0pt; color:black; ">,</span><span style="font-size:11.0pt; color:blue; ">...</span><span style="font-size:11.0pt; "> </span></p>
  <p class="MsoNormal" style="text-autospace:none;border:none;padding:0in;"><span style="font-size:11.0pt; color:black; ">    </span><span style="font-size:11.0pt; color:#A020F0; ">'S1_ERPs_30Hz_copy.erp'</span><span style="font-size:11.0pt; color:black; ">, </span><span style="font-size:11.0pt; color:#A020F0; ">'pathname', '/Users/etfoo/Desktop/tutorial_script/');</span><span style="font-size:11.0pt; color:black; ">  </span><span style="font-size:11.0pt; color:black; "> </span></p>
  <p class="MsoNormal" style="text-autospace:none;border:none;padding:0in;"><span style="font-size:11.0pt; color:forestgreen; ">%The following command uses Matlab's <em>Current Folder</em></span><em><span style="font-size:11.0pt; color:forestgreen; "> </span></em></p>
  <p class="MsoNormal" style="text-autospace:none;border:none;padding:0in;"><span style="font-size:11.0pt; color:black; ">ERP = pop_savemyerp(ERP, </span><span style="font-size:11.0pt; color:#A020F0; ">'erpname'</span><span style="font-size:11.0pt; color:black; ">, </span><span style="font-size:11.0pt; color:#A020F0; ">'S1_ERPs_30Hz_copy.set'</span><span style="font-size:11.0pt; color:black; ">, </span><span style="font-size:11.0pt; color:#A020F0; ">'filename'</span><span style="font-size:11.0pt; color:black; ">,</span><span style="font-size:11.0pt; color:blue; ">...</span><span style="font-size:11.0pt; "> </span></p>
  <p class="MsoNormal" style="text-autospace:none;border:none;padding:0in;"><span style="font-size:11.0pt; color:black; ">    </span><span style="font-size:11.0pt; color:#A020F0; ">'S1_ERPs_30Hz_copy.set.erp'</span><span style="font-size:11.0pt; color:black; ">, </span><span style="font-size:11.0pt; color:#A020F0; ">'gui'</span><span style="font-size:11.0pt; color:black; ">,</span><span style="font-size:11.0pt; color:#A020F0; ">'no'</span><span style="font-size:11.0pt; color:black; ">);  </span><span style="font-size:11.0pt; color:black; "> </span></p>
  <p class="MsoNormal" style="text-autospace:none;border:none;padding:0in;"><span style="font-size:11.0pt; ">&nbsp;</span></p>
</div>
<p class="MsoNormal" style="text-autospace:none;"><strong><span style="font-family:Courier; ">&nbsp;</span></strong></p>
<p class="paragraph">&nbsp;</p>
<p class="paragraph">Now select <strong>ERPLAB &gt; ERP Operations &gt; ERP Bin Operations</strong>.  The window shown below will appear.</p>
<p class="paragraph"><img src="../Images/tutorial_bin operations_2.png" width="855" height="372" /></p>
<p class="paragraph">&nbsp;</p>
<p class="paragraph">The right panel lists the existing bins in your ERPset, and the left panel shows a set of equations that you write to create new bins from the existing bins.  In the example shown here, an equation is written to create a new bin 3 within the current ERPset that is equal to the existing bin 2 minus the existing bin 1 (the rare-minus-frequent difference wave).  A label is also provided for the new bin.  You should type this equation into the window, as shown in the screenshot above.</p>
<p class="paragraph">You can create as many new bins as you'd like in one step, defining one bin on each line of the left panel.  You can save your bin equations in a text file (by clicking <strong>Save list as</strong>) and you can read in a previously saved set (by clicking <strong>Load list</strong>).  </p>
<p class="paragraph"><em>Hint: You can see examples of the types of equations that are valid by clicking the <strong>Equation examples</strong> button.  This will create sample equations.  These will probably not be directly useful (because ERPLAB doesn't know what would make sense for a given experiment), but they will show you the kinds of things that are possible.</em></p>
<p class="paragraph">Once you have defined the new bin as shown in the screenshot above, make sure that <strong>Modify existing ERPset (recursive updating)</strong> is selected so that you will add the new bin to the existing ERPset.  Then click <strong>RUN</strong> to create the new bin.  After you've updated the ERPset, you should save it to a file named &quot;S1_ERP_diff&quot; with <strong>ERPLAB &gt; Duplicate or rename current ERPset </strong>(we will need this file later).<span style="color:black; "> </span></p>
<p class="paragraph">Once you've created the new bin, you can plot it with <strong>ERPLAB &gt; Plot ERP Waveforms</strong>.  If you select only bin 3, the result should look like the screenshot below.</p>
<p class="paragraph"><img src="images/ploterps8.jpg" alt="ploterps8" width="602" height="527" border="1" /></p>
<div style="border:double windowtext 3.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt;">
  <p class="paragraph" style="border:none;padding:0in;"><strong><span style="font-size:12.0pt; ">Equivalent Script Command:</span></strong></p>
  <p class="MsoNormal" style="text-autospace:none;border:none;padding:0in;"><span style="font-size:11.0pt; color:forestgreen; ">%ERP bin operations</span><span style="font-size:11.0pt; "> </span></p>
  <p class="MsoNormal" style="text-autospace:none;border:none;padding:0in;"><span style="font-size:11.0pt; color:forestgreen; ">% b3=b2-b1 label Rare minus Frequent difference wave</span><span style="font-size:11.0pt; "> </span></p>
  <p class="MsoNormal" style="text-autospace:none;border:none;padding:0in;"><span style="font-size:11.0pt; color:black; ">ERP = pop_binoperator( ERP,</span><span style="font-size:11.0pt; color:blue; "> </span><span style="font-size:11.0pt; color:black; ">{</span><span style="font-size:11.0pt; color:#A020F0; ">'b3= b2-b1 label Rare minus Frequent difference wave'</span><span style="font-size:11.0pt; color:black; "> });  </span></p>
  <p class="MsoNormal" style="text-autospace:none;border:none;padding:0in;"><span style="font-size:11.0pt; color:forestgreen; ">%Plotting ERP Waveforms from bin 3 with default parameters</span><span style="font-size:11.0pt; "> </span></p>
  <p class="MsoNormal" style="text-autospace:none;border:none;padding:0in;"><span style="font-size:11.0pt; color:black; ">pop_ploterps( ERP, 3, 1:16); </span></p>
</div>
<p class="paragraph">&nbsp;</p>
<p class="paragraph">In this example, we've simply added a new bin to the current ERPset.  Note, however, that you can also update the existing bins in this mode.  In addition, any changes you make in one equation can influence the results of the next equation.  For example, after creating the difference wave in bin 3, you could have an equation that uses this difference wave to create a new bin 4.</p>
<h2 style="margin-left:.55in;text-indent:-.55in;">Creating a new ERPset (independent transformations)</h2>
<p class="paragraph">In this example, we will use <strong>ERPLAB &gt; ERP Bin Operations</strong> to re-order the bins in the output from the previous step.  We will also create an additional bin that shows how to implement a somewhat more complicated transformation.  If you select <strong>ERPLAB &gt; ERP Operations &gt; ERP Bin Operations</strong> after performing the previous step, you will see that the newly created bin (bin 3) is now listed in the right panel as an existing bin (see screenshot below).  We are going to create a new ERPset in this example, so select <strong>Create new ERPset (independent transformations)</strong>.  The equations in the left panel of the window will create a new ERPset in which the first 3 bins are re-ordered versions of the bins in the current ERPset and the 4<sup>th</sup> bin is the vector distance between the first two bins:</p>
<p class="paragraph"><strong>nb1 = b3 label Rare minus Frequent difference wave</strong> — This means that new bin 1 (nb1) in the new ERPset will be equal to the original bin 3 (b3) in the current ERPset)</p>
<p class="paragraph"><strong>nb2 = b1 label Frequent</strong> — This means that new bin 2 (nb1) in the new ERPset will be equal to the original bin 1 (b1) in the current ERPset)</p>
<p class="paragraph"><strong>nb3 = b2 label Rare</strong> — This means that new bin 1 (nb1) in the new ERPset will be equal to the original bin 2 (b2) in the current ERPset)</p>
<p class="paragraph"><strong>nb4 = sqrt((b1*b1) + (b2*b2)) label Vector length</strong> — This means that new bin 4 (nb4) is the Pythagorean distance between the original bins 1 and 2 (rare and frequent)<strong> </strong></p>
<p class="paragraph"><img src="../Images/tutorial_bin operations_3.png" width="715" height="290" /></p>
<p class="paragraph">After you complete your equation list, you can choose to save it by clicking <strong>Save list as</strong>. You will prompted to save your ERPset. You can save this name as &quot;S1_ERP_bo.txt&quot; and just click <strong>OK</strong>. </p>
<p class="paragraph">Note that you can also recombine bins with different subsets of channels (e.g., to make contra-minus-ipsi difference waves to isolate the lateralized readiness potential or the N2pc wave).  See the section on Bin Operations in the ERPLAB User's Manual for details.  This can be done only in the <strong>independent transformations</strong> mode.</p>
<p class="paragraph">When you use the <strong>independent transformations</strong> mode, the Bin Operations necessarily creates a new ERPset.  You will therefore see the window shown in the screenshot below after you run Bin Operations in this mode.  This allows you to name the new ERPset and, optionally, save it as a file on your hard drive.  You should name it S1_ERP_diff2 and save it to the disk.</p>
<p><img src="images/save_erpset2.jpg" alt="save_erpset2" width="487" height="335" /></p>
<p class="paragraph"><em>Hint: There is no reason to first make a duplicate of the ERPset in this mode, because it always creates a new ERPset. In the <strong>recursive updating</strong> mode, however, creating a duplicate is useful (although not necessary) so that you can easily step backward and try again if you make a mistake or change your mind.</em></p>
<div style="border:double windowtext 3.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt;">
  <p class="paragraph" style="border:none;padding:0in;"><strong><span style="font-size:12.0pt; ">Equivalent Script Command:</span></strong></p>
  <p class="MsoNormal" style="text-autospace:none;border:none;padding:0in;"><span style="font-size:11.0pt; color:forestgreen; ">%Creating new bins</span><span style="font-size:11.0pt; "> </span></p>
  <p class="MsoNormal" style="text-autospace:none;border:none;padding:0in;"><span style="font-size:11.0pt; color:black; ">ERP = pop_binoperator( ERP, {</span><span style="font-size:11.0pt; color:#A020F0; ">'nb1=b3 label Rare minus Frequent difference wave'</span><span style="font-size:11.0pt; color:blue; "> </span><span style="font-size:11.0pt; color:#A020F0; ">'nb2=b1 label Frequent'</span><span style="font-size:11.0pt; color:black; "> </span><span style="font-size:11.0pt; color:#A020F0; ">'nb3=b2 label Rare'</span><span style="font-size:11.0pt; color:blue; "> </span><span style="font-size:11.0pt; color:#A020F0; ">'nb4=sqrt((b1*b1)+(b2*b2)) label Vector length'</span><span style="font-size:11.0pt; color:black; ">}</span><span style="font-size:11.0pt; color:black; ">);  </span><span style="font-size:11.0pt; "> </span></p>
</div>
<p class="MsoNormal" style="text-autospace:none;"><span style="font-family:Courier; ">&nbsp;</span></p>
<p>&nbsp;</p>
<table width="100%" border="0">
  <tr>
    <td><a href="Filtering.html">&lt;&lt;Filtering</a></td>
    <td><a href="index.html">Table of Contents</a></td>
    <td><a href="Channel_Operations.html">Channel Operations&gt;&gt;</a></td>
  </tr>
</table>
</body>
</html>
